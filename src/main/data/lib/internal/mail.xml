<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0">
    <xqdoc:control>
        <xqdoc:date>2019-05-14T12:08:24.519-04:00</xqdoc:date>
        <xqdoc:location>java:org.exist.xquery.modules.mail.MailModule</xqdoc:location>
    </xqdoc:control>
    <xqdoc:module type="library">
        <xqdoc:uri>http://exist-db.org/xquery/mail</xqdoc:uri>
        <xqdoc:name>mail</xqdoc:name>
        <xqdoc:comment>
            <xqdoc:description>A module for performing email related functions</xqdoc:description>
        </xqdoc:comment>
    </xqdoc:module>
    <xqdoc:functions>
        <xqdoc:function>
            <xqdoc:name>mail:get-mail-session</xqdoc:name>
            <xqdoc:signature>mail:get-mail-session($properties as element()?) as xs:long?</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Open's a JavaMail session.</xqdoc:description>
                <xqdoc:param>$properties? An optional JavaMail session properties in the form &lt;properties&gt;&lt;property name="" value=""/&gt;&lt;/properties&gt;.  The JavaMail properties are spelled out in Appendix A of the JavaMail specifications.</xqdoc:param>
                <xqdoc:return>xs:long? : an xs:long representing the session handle.</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:get-mail-store</xqdoc:name>
            <xqdoc:signature>mail:get-mail-store($mail-handle as xs:integer) as xs:long?</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Opens a mail store. Host/User/Password/Protocol values will be obtained from the session.</xqdoc:description>
                <xqdoc:param>$mail-handle The JavaMail session handle retrieved from mail:get-mail-session()</xqdoc:param>
                <xqdoc:return>xs:long? : an xs:long representing the store handle.</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:close-mail-store</xqdoc:name>
            <xqdoc:signature>mail:close-mail-store($mail-store-handle as xs:integer) as item()</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Closes a mail store.</xqdoc:description>
                <xqdoc:param>$mail-store-handle The mail store handle retrieved from mail:get-mail-store()</xqdoc:param>
                <xqdoc:return>item()</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:get-mail-folder</xqdoc:name>
            <xqdoc:signature>mail:get-mail-folder($mail-store-handle as xs:integer, $foldername as xs:string) as xs:long?</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Opens a mail folder.</xqdoc:description>
                <xqdoc:param>$mail-store-handle The mail store handle retrieved from mail:get-mail-store()</xqdoc:param>
                <xqdoc:param>$foldername The name of the folder to open</xqdoc:param>
                <xqdoc:return>xs:long? : an xs:long representing the folder handle.</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:close-mail-folder</xqdoc:name>
            <xqdoc:signature>mail:close-mail-folder($mail-folder-handle as xs:integer, $expunge as xs:boolean) as item()</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Closes a mail folder.</xqdoc:description>
                <xqdoc:param>$mail-folder-handle The mail folder handle retrieved from mail:get-mail-folder()</xqdoc:param>
                <xqdoc:param>$expunge A boolean that specifies whether to expunge the folder on close.</xqdoc:param>
                <xqdoc:return>item()</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:get-message-list</xqdoc:name>
            <xqdoc:signature>mail:get-message-list($mail-folder-handle as xs:integer) as xs:long?</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Returns a message list of all messages in a folder.</xqdoc:description>
                <xqdoc:param>$mail-folder-handle The mail folder handle retrieved from mail:get-mail-folder()</xqdoc:param>
                <xqdoc:return>xs:long? : an xs:long representing the message list handle.</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:search-message-list</xqdoc:name>
            <xqdoc:signature>mail:search-message-list($mail-folder-handle as xs:integer, $search-parameters as element()) as xs:long?</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Searches messages in a folder. Search terms are of the form &lt;searchTerm type="xxx"&gt;...&lt;/searchTerm&gt;.  Valid types include: not, and, or, from, subject, body, recipient, header, flag, sent, received. &lt;searchTerm type="not"&gt; requires a single nested child search term. &lt;searchTerm type="and"&gt; and &lt;searchTerm type="or"&gt; must have one or more nested child search terms. &lt;searchTerm type="from" pattern="pat"&gt;, &lt;searchTerm type="subject" pattern="pat"&gt; and &lt;searchTerm type="body" pattern="pat"&gt;  require a pattern attribute and will search for a substring that matches the pattern. &lt;searchTerm type="recipient" pattern="pat" recipientType="to|cc|bcc"&gt; requires pattern and recipientType attributes. &lt;searchTerm type="header" pattern="pat" name="Content-Type"&gt; requires pattern and name attributes. &lt;searchTerm type="flag" flag="answered|deleted|draft|recent|seen" value="true|false"&gt; requires flag and value attributes. &lt;searchTerm type="sent" comparison="eq|gt|ge|lt|le|ne" format="format" date="date"&gt; and &lt;searchTerm type="received" comparison="eq|gt|ge|lt|le|ne" format="format" date="date"&gt; require comparison, format and date attributes. The format string should conform to Java SimpleDateFormat specifications and the date string must conform to the specified format string.</xqdoc:description>
                <xqdoc:param>$mail-folder-handle The mail folder handle retrieved from mail:get-mail-folder()</xqdoc:param>
                <xqdoc:param>$search-parameters The xml fragment defining the search terms</xqdoc:param>
                <xqdoc:return>xs:long? : an xs:long representing the message list handle.</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:get-message-list-as-xml</xqdoc:name>
            <xqdoc:signature>mail:get-message-list-as-xml($message-list-handle as xs:integer, $include-headers as xs:boolean) as element()?</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Returns a message list of all messages in a folder as XML.  If there are no messages in the list, an empty sequence will be returned</xqdoc:description>
                <xqdoc:param>$message-list-handle The message list handle retrieved from mail:get-message-list() or mail:search-message-list()</xqdoc:param>
                <xqdoc:param>$include-headers A boolean specifying whether to include message headers</xqdoc:param>
                <xqdoc:return>element()? : the list of all messages in a folder as XML</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:close-message-list</xqdoc:name>
            <xqdoc:signature>mail:close-message-list($message-list-handle as xs:integer) as item()</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Closes a message list.</xqdoc:description>
                <xqdoc:param>$message-list-handle The message list handle retrieved from mail:get-message-list() or mail:search-message-list()</xqdoc:param>
                <xqdoc:return>item()</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:get-messages</xqdoc:name>
            <xqdoc:signature>mail:get-messages($message-list-handle as xs:integer, $message-numbers as xs:integer*) as element()?</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Returns a sequence of emails as XML.  If there are no messages-numbers in the list, an empty sequence will be returned. Please see get_messages_example.xql.</xqdoc:description>
                <xqdoc:param>$message-list-handle The message list handle retrieved from mail:get-message-list() or mail:search-message-list()</xqdoc:param>
                <xqdoc:param>$message-numbers* The messages to retrieve using the numbers from the message-list '//mail:message/@number' </xqdoc:param>
                <xqdoc:return>element()? : the chosen messages as XML mail:messages/mail:message</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:send-email</xqdoc:name>
            <xqdoc:signature>mail:send-email($mail-handle as xs:long, $email as element()+) as item()</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Sends an email using javax.mail messaging libraries.</xqdoc:description>
                <xqdoc:param>$mail-handle The JavaMail session handle retrieved from mail:get-mail-session()</xqdoc:param>
                <xqdoc:param>$email+ The email message in the following format: &lt;mail&gt; &lt;from/&gt; &lt;reply-to/&gt; &lt;to/&gt; &lt;cc/&gt; &lt;bcc/&gt; &lt;subject/&gt; &lt;message&gt; &lt;text/&gt; &lt;xhtml/&gt; &lt;/message&gt; &lt;attachment filename="" mimetype=""&gt;xs:base64Binary&lt;/attachment&gt; &lt;/mail&gt;.</xqdoc:param>
                <xqdoc:return>item()</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
        <xqdoc:function>
            <xqdoc:name>mail:send-email</xqdoc:name>
            <xqdoc:signature>mail:send-email($email as element()+, $server as xs:string?, $charset as xs:string?) as xs:boolean+</xqdoc:signature>
            <xqdoc:comment>
                <xqdoc:description>Sends an email through the SMTP Server.</xqdoc:description>
                <xqdoc:param>$email+ The email message in the following format: &lt;mail&gt; &lt;from/&gt; &lt;reply-to/&gt; &lt;to/&gt; &lt;cc/&gt; &lt;bcc/&gt; &lt;subject/&gt; &lt;message&gt; &lt;text/&gt; &lt;xhtml/&gt; &lt;/message&gt; &lt;attachment filename="" mimetype=""&gt;xs:base64Binary&lt;/attachment&gt; &lt;/mail&gt;.</xqdoc:param>
                <xqdoc:param>$server? The SMTP server.  If empty, then it tries to use the local sendmail program.</xqdoc:param>
                <xqdoc:param>$charset? The charset value used in the "Content-Type" message header (Defaults to UTF-8)</xqdoc:param>
                <xqdoc:return>xs:boolean+ : true if the email message was successfully sent</xqdoc:return>
            </xqdoc:comment>
        </xqdoc:function>
    </xqdoc:functions>
</xqdoc:xqdoc>